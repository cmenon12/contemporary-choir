<!-- This is the code used in a custom HTML block on the website to
generate either a lie or a prompt to use their truth for the
participant when they click the button. -->

<script>

  // Put the lies in here. They cannot contain any "
  const lies = ["1This sentence is a lie.",
    "2This sentence is a lie.",
    "3This sentence is a lie.",
    "4This sentence is a lie.",
    "5This sentence is a lie.",
    "6This sentence is a lie."];

  let justHadTruth = false;
  const secondButton = document.getElementById("wilty-generate-new-lie");

  /**
   * 50/50 chance of asking for their truth or providing a lie.
   * Importantly if the button is clicked again,
   * then they won't be asked for their truth again.
   */
  function generateWilty() {

    // Returns a random integer from 0 to 1, so 50/50
    // Will also not ask for a truth if it just asked for one.
    if (Math.floor(Math.random() * 2) === 1 && justHadTruth === false) {

      // Ask for their truth
      // Provide the option to get a lie if they don't have a truth
      document.getElementById("wilty-answer").innerHTML = "Read out your truth to the group.";
      secondButton.innerHTML = "I didn't bring a truth";
      secondButton.style.visibility = "visible";
      justHadTruth = true;

    } else {
      // Provide a random lie
      randomLie()
      justHadTruth = false;

    }

  }

  /**
   * Returns a random lie and removes that from the array.
   */
  function randomLie() {

    // If all of the lies have been used
    if (lies.length === 0) {
      document.getElementById("wilty-answer").innerHTML = "We're out of lies! Can you read out your truth?";

      // Hide the button to generate a new lie
      secondButton.style.visibility = "hidden";

    } else {
      // Pick a random lie, remove it, and return it
      const randomNum = Math.floor(Math.random() * lies.length);
      const chosenLie = lies[randomNum];
      lies.splice(randomNum, 1);
      document.getElementById("wilty-answer").innerHTML = chosenLie;

      // Provide a button to generate a new lie
      secondButton.innerHTML = "We've already had this lie."
      secondButton.style.visibility = "visible";
    }
  }
</script>

<button id="wilty-generate" style="background-color: #E62073; width: 100%; font-size: 25px" onclick="generateWilty()">Click for a truth or a lie!</button>
<h2 id="wilty-answer" style="text-align: center; color: #222; font: bold 32px NowRegular, sans-serif"></h2>
<button id="wilty-generate-new-lie" style="visibility: hidden; background-color: #333; width: 100%; font-size: 22px" onclick="randomLie()">We've already had this lie</button>

