<!DOCTYPE html>
<html lang="en">
<head>
    <base target="_top">
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">

    <style>
        h1 {
            line-height: 1.1;
            margin-top: 5px;
            text-align: center;
        }

        body {
            background-color: #DBEDF5;
        }

    </style>

    <?!= include("sidebar-js"); ?>

</head>
<body>
<div class="sidebar">
    <h1>Download your Society Ledger</h1>

    <form id="ledgerForm">

        <div class="inline form-group">
            <label for="groupId"><b>Group ID</b></label>
            <input type="number" name="groupId" id="groupId" required value="<?= expense365Config.groupId ?>">
            <span class="error" id="groupIdError" style="display:none">Please enter your society Group ID.<br></span>
            <span class="secondary">You can find this from your society admin URL (e.g. 12345 in exeterguild.org/organisation/admin/12345).</span>
        </div>
        <br><br>
        <div class="inline form-group">
            <label for="email"><b>Email</b></label>
            <input type="email" name="email" id="email" required value="<?= expense365Config.email ?>">
            <span class="error" id="emailError"
                  style="display:none">Please enter your eXpense365 email address.<br></span>
        </div>
        <br><br>
        <div class="form-group">
            <label for="password"><b>Password</b></label>
            <input type="password" name="password" id="password" required value="<?= expense365Config.password ?>">
            <span class="error" id="passwordError"
                  style="display:none">Please enter your eXpense365 password.<br></span>
        </div>
        <br>
        <b>What do you want to do?</b>
        <div>
            <input type="checkbox" name="savePDF" id="savePDF"
                   <? if (expense365Config.lastAction == "savePDF") { ?>checked<?}?>>
            <label for="savePDF">Save PDF to Drive</label>
        </div>
        <div>
            <input type="checkbox" name="saveXLSX" id="saveXLSX"
                   <? if (expense365Config.lastAction == "saveXLSX") { ?>checked<?}?>>
            <label for="saveXLSX">Save XLSX to Drive </label>
        </div>
        <div>
            <input type="checkbox" name="import" id="import"
                   <? if (expense365Config.lastAction == "import") { ?>checked<?}?>>
            <label for="import">Import into Sheets </label>
        </div>
        <span class="error" id="choseNothingError" style="display:none">You must choose something to do.<br></span>

        <br>
        <div>
            <input type="checkbox" name="saveDetails"
                   id="saveDetails" <? if (expense365Config.saveForNextTime != false) { ?>checked<?}?>>
            <label for="saveDetails">Save for next time</label><br>
            <span class="secondary">This will be saved for you individually.</span>
        </div>
        <br>
        <button class="create" id="GO!" onclick="processForm('GO!')">GO!</button>
        <button id="Clear saved data" onclick="processForm('Clear saved data')" formnovalidate>Clear saved data</button>
        <input type="hidden" name="action" id="actionInput" value="">

    </form>
    
    <br>
    <div id="result"></div>
</div>

</body>
</html>